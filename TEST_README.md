# Тесты для добавления пользователей в базу данных mvc_hibernate

## Описание

Данный проект содержит комплексные тесты для проверки функциональности добавления новых пользователей в таблицу `users` базы данных `mvc_hibernate`.

## Структура тестов

### 1. UserServiceTest.java
Тесты сервисного слоя для работы с пользователями:
- Создание пользователя с именем и балансом
- Создание пользователя с объектом Users
- Получение пользователя по ID
- Получение всех пользователей
- Проверка существования пользователя
- Подсчет количества пользователей
- Удаление пользователя

### 2. UserControllerTest.java
Тесты контроллера для проверки HTTP endpoints:
- Тест страницы добавления пользователя
- Тест добавления нового пользователя через POST запрос
- Тест добавления пользователя с пустым именем
- Тест добавления пользователя с отрицательным балансом
- Тест страницы списка пользователей

### 3. UserRepositoryTest.java
Тесты репозитория для проверки JPA операций:
- Сохранение пользователя
- Поиск пользователя по ID
- Поиск несуществующего пользователя
- Получение всех пользователей
- Проверка существования пользователя
- Подсчет пользователей
- Удаление пользователя
- Обновление пользователя

### 4. UserIntegrationTest.java
Интеграционные тесты для проверки полного цикла работы:
- Полный цикл создания пользователя
- Создание нескольких пользователей
- Обновление пользователя
- Удаление пользователя
- Тесты с различными значениями баланса (0, отрицательный, большой)
- Тесты с специальными символами в имени
- Тесты с длинными именами

### 5. UserDataJpaTest.java
Тесты с использованием @DataJpaTest для изолированного тестирования JPA:
- Сохранение и поиск пользователя
- Обновление пользователя
- Удаление пользователя
- Получение всех пользователей
- Проверка существования пользователя
- Подсчет пользователей
- Тесты с различными значениями баланса
- Тесты с специальными символами в имени

## Конфигурация

### База данных
Тесты используют ту же базу данных `mvc_hibernate`, что и основное приложение:
- URL: `jdbc:mysql://localhost:3306/mvc_hibernate`
- Пользователь: `root`
- Пароль: `Vad310865!`

### Профиль тестирования
Используется профиль `test` с настройками:
- `spring.jpa.hibernate.ddl-auto=create-drop` - пересоздание схемы для каждого теста
- Отключен показ SQL для чистоты вывода тестов

## Запуск тестов

### Запуск всех тестов
```bash
mvn test
```

### Запуск конкретного тестового класса
```bash
mvn test -Dtest=UserServiceTest
mvn test -Dtest=UserControllerTest
mvn test -Dtest=UserRepositoryTest
mvn test -Dtest=UserIntegrationTest
mvn test -Dtest=UserDataJpaTest
```

### Запуск конкретного теста
```bash
mvn test -Dtest=UserServiceTest#testSaveUserWithNameAndBalance
```

## Требования

1. **MySQL сервер** должен быть запущен
2. **База данных mvc_hibernate** должна существовать
3. **Пользователь root** с паролем `Vad310865!` должен иметь доступ к базе данных

## Структура базы данных

Таблица `users`:
- `id` (INT, AUTO_INCREMENT, PRIMARY KEY)
- `name` (VARCHAR)
- `balanse` (INT)

## Примечания

- Все тесты используют аннотацию `@Transactional` для автоматического отката изменений
- Тесты с `@DataJpaTest` изолированы и не загружают весь контекст Spring
- Интеграционные тесты проверяют полный стек приложения
- Тесты покрывают различные сценарии: нормальные случаи, граничные случаи, специальные символы

## Результаты тестирования

После успешного выполнения всех тестов вы должны увидеть:
- Все тесты проходят (зеленые)
- Пользователи корректно сохраняются в базу данных
- Все CRUD операции работают правильно
- Контроллер корректно обрабатывает HTTP запросы
- Сервисный слой правильно делегирует операции репозиторию 